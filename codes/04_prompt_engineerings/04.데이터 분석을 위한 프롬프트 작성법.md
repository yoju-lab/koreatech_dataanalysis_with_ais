## 데이터 분석을 위한 프롬프트 작성법

이번 강의에서는 **데이터 분석 업무에 최적화된 프롬프트 작성 요령**을 학습합니다. AI 모델에게 원하는 답변을 얻으려면 질문(요청)을 제대로 하는 것이 매우 중요합니다. 이미 기본적인 프롬프트 사용법은 알고 계시겠지만, 데이터를 다루는 맥락에서는 몇 가지 추가로 고려할 점이 있습니다.

### 이론: 효과적인 프롬프트의 특징

1. **맥락(Context) 제공:** 모델은 사용자가 제공한 정보에 의존하여 답변합니다. 데이터의 도메인, 목표, 현재까지의 진행 상황 등을 간략히 설명하면 더 관련성 높은 답변을 얻을 수 있습니다.  
   - *예:* "소매점 매출 데이터"만 말하는 것보다 "한 소매점의 월별 매출 데이터 (2018-2022)가 있다"고 하면 범위와 주제를 이해시키기 좋습니다.
2. **구체적인 질문/요청:** 막연한 질문보다 구체적인 요청이 정확한 답을 이끌어냅니다.  
   - *예:* "이 데이터 좀 분석해줘"보다는 "이 데이터에서 월별 매출 추이를 파악하고, 계절 패턴이 있는지 알려줘"가 좋습니다.
3. **형식 지시:** 필요한 출력 형태를 알려줄 수 있습니다. 목록, 표, 간략한 문장, 코드 등 원하는 형태가 있다면 명시합니다.  
   - *예:* "단계별로 번호를 매겨 목록으로 답변해주세요." 또는 "파이썬 pandas 코드로 예시를 보여주세요."
4. **예시 제공 (Few-shot):** 복잡한 요청의 경우 원하는 답변의 예를 일부 제공하면 모델이 그 형식을 따라줍니다.  
   - *예:* "첫 두 달의 분석 결과를 예로 들면: 1월 - 증가세, 2월 - 감소세. 이런 식으로 각 월별 트렌드를 분석해주세요."
5. **품질 및 제약 조건:** 답변의 품질 기준이나 제약을 줄 수 있습니다.  
   - *예:* "근거를 함께 설명해주세요." 또는 "200자 이내로 답변해주세요."

이러한 요소들을 적절히 활용하면 모델이 더 만족스러운 답을 내놓을 확률이 높아집니다. 반면, **프롬프트가 불명확하면** AI는 엉뚱한 답변을 하거나 추가 질문이 필요함을 알리는 경우도 있습니다. 

**예시 비교:** 잘못된 프롬프트 vs 개선된 프롬프트  
- 잘못된: "*이 데이터 말해줘.*" (모호함: 어떤 면을 말해줘야 하는지 불분명)  
- 개선된: "*이 데이터의 요약 통계를 알려줘. 예를 들어 변수별 평균, 중앙값, 표준편차 등을 계산하고 주요 특징을 설명해줘.*" (구체적 요구)

모델에게 질문할 때는 **한글**로 물어봐도 잘 알아듣지만, **데이터 컬럼명이나 코드**는 영문으로 전달해야 이해가 정확합니다 (예: `Sales`, `Date` 등의 컬럼명 그대로 사용).

### 실습: 프롬프트 개선하기

이제 간단한 데이터 시나리오에 대해 **프롬프트를 점진적으로 다듬어가며** 어떤 차이가 생기는지 살펴보겠습니다. 시나리오는 다음과 같습니다:

> **시나리오:** 어느 도시의 월별 강수량 데이터가 있습니다. 이 데이터를 분석하여 **계절별 강수량 패턴**을 알아내고자 합니다.

1. **모호한 질문으로 시도:** 우선 매우 짧고 모호한 질문을 던져봅시다. (일부러 나쁜 프롬프트를 사용)

```python
messages = [
    {"role": "user", "content": "강수량 데이터 분석 좀 해줘"}
]
response = client.chat.completions.create(
    model="gpt-4o-mini",
    messages=messages
)
print(response.choices[0].message.content)
```

위와 같은 *애매한 프롬프트*를 주면, AI는 구체적으로 무엇을 해야 할지 몰라 일반적인 답변을 내놓을 수 있습니다. 예를 들면 "*강수량 데이터를 분석하려면, 우선 데이터를 시각화하고, 평균 강수량을 비교해보세요...*" 같은 **원론적인 조언**을 할 가능성이 있습니다. 또는 추가 정보가 필요하다며 질문을 던질 수도 있습니다. 이는 원하는 답과는 거리가 있습니다.

2. **맥락과 구체성을 추가한 질문:** 이제 프롬프트를 개선해봅니다. **분석 대상과 목표를 명확히** 하겠습니다.

```python
prompt = (
    "1980년부터 2020년까지 서울의 월별 강수량(mm) 데이터가 있습니다. "
    "이 데이터를 봄, 여름, 가을, 겨울 **계절별로 평균 강수량이 어떻게 다른지** 알고 싶습니다. "
    "계절별 평균 강수량을 계산하고, 어떤 계절에 비가 많이 오는지 알려주세요."
)
messages = [
    {"role": "user", "content": prompt}
]
response = client.chat.completions.create(
    model="gpt-4o-mini",
    messages=messages
)
analysis = response.choices[0].message.content
print(analysis)
```

이 프롬프트는 다음을 명시합니다:
- 데이터 기간과 지역: 1980~2020년, 서울
- 데이터 특징: 월별 강수량(mm)
- 알고 싶은 것: 계절별 평균 강수량 비교 (봄, 여름, 가을, 겨울)
- 기대하는 답: 계절별 평균치와 어느 계절에 강수량이 많은지 설명

AI는 이 요청을 이해하고, 아마도 **계절별 평균 강수량 결과와 간단한 분석**을 텍스트로 줄 것입니다. 예를 들어 출력은 다음과 같을 수 있습니다 (실제 값은 임의로 가정):

```
서울의 월별 강수량 데이터를 계절별로 평균 내면 다음과 같습니다:

- 봄(3~5월): 평균 85mm
- 여름(6~8월): 평균 310mm
- 가을(9~11월): 평균 120mm
- 겨울(12~2월): 평균 30mm

**분석:** 여름철 평균 강수량이 약 310mm로 가장 높아 강우량이 많습니다. 특히 장마가 있는 7월에 강수가 집중되어 있어 여름에 비가 많이 내립니다. 반면 겨울철 평균 강수량은 30mm 정도로 가장 낮아, 서울에서는 겨울이 건조한 계절임을 알 수 있습니다.
```

이렇게 **맥락을 추가하고 구체적 질문**을 하니, 훨씬 유용한 정보를 얻을 수 있었습니다. 만약 단순히 평균치를 나열하는 것 이상의 **추가 요구사항**이 있었다면 (예: "표로 보여줘" 또는 "추세에 대한 인사이트도 줘"), 그 부분도 프롬프트에 포함해서 요청하면 됩니다.

3. **출력 형식 지정과 추가 요구:** 마지막으로, **결과를 표 형식**으로 달라고 요구해보겠습니다. 또한 **한글로 답하되 숫자는 소숫점 없이** 표시하도록 조건을 넣어보겠습니다.

```python
prompt = (
    "1980년부터 2020년까지 서울의 월별 강수량(mm) 데이터로 계절별 평균 강수량을 계산했습니다. "
    "결과를 표로 정리해서 알려주세요. "
    "각 계절에 해당하는 평균 강수량(mm)을 정수로 표기하고, 어느 계절에 비가 가장 많이 오는지도 설명해주세요."
)
messages = [
    {"role": "user", "content": prompt}
]
response = client.chat.completions.create(model="gpt-4o-mini", messages=messages)
print(response.choices[0].message.content)
```

이 경우 AI는 아마도 마크다운 표 형태로 답변할 것입니다. 예를 들면:

```
| 계절 | 평균 강수량 (mm) |
| --- | --- |
| 봄 | 85 |
| 여름 | 310 |
| 가을 | 120 |
| 겨울 | 30 |

여름의 평균 강수량이 310mm로 가장 높아서, 서울에서는 **여름에 강수량이 가장 많습니다**. 반대로 겨울은 30mm로 가장 낮습니다.
```

이처럼 원하는 형식(표)과 추가 설명까지 얻어낼 수 있습니다. 프롬프트에 조건을 달았기 때문에 숫자를 정수로 표기하고(소수점 없음), 설명도 마지막에 붙은 것을 확인할 수 있습니다.

### 프롬프트 작성 팁 요약

- 요청하고자 하는 **작업**(**Task**)과 **대상(Data/context)**, 그리고 **기대 출력**을 명확히 기술합니다.
- 필요하면 단계적으로 물어보세요. 처음부터 복잡하게 한꺼번에 물어보는 것보다, 답을 보고 추가 질문하는 **대화형 접근**이 효과적일 때도 있습니다.
- **시스템 메시지**를 활용하여 모델의 **스타일이나 역할**을 지정할 수 있습니다 (예: "당신은 분석 전문가" 등).
- 모델이 오해할 수 있는 부분(예: 축약어, 특이한 고유명사)은 풀어서 쓰거나 설명을 덧붙입니다.
- 한 번에 너무 많은 것을 요구하지 말고, 여러 번에 나누어 물으면 모델이 더 정확히 답합니다.

> **실습 과제:**  
> - 앞서 개선한 프롬프트 사례처럼, 여러분이 오전에 얻은 **프로젝트 계획** 중 한 단계를 골라 그 부분에 대한 질문을 명확하게 작성해보세요. (예: "3단계 EDA에서 어떤 시각화를 해야 하는지?")  
> - 또는 자신이 다뤄본 데이터셋에 대해 두 가지 버전의 프롬프트를 작성해 비교합니다. 하나는 최소한의 정보만 담고, 다른 하나는 충분한 맥락과 요구사항을 담습니다. 두 프롬프트를 각각 AI에게 보내 응답의 차이를 비교해보세요.  
> - 결과를 동료와 공유하면서 **무엇이 달랐는지**, **어떻게 하면 더 개선할 수 있을지** 토론합니다.

---


